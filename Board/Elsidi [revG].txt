                                 Elsidi
                                  revG



RATINGS

   o  Input voltage ........: 12V
   o  Input current (max)...: 1A


BOARD

   o  Board size ...........: 65.00 x 72.00 mm


PARTS                              

   o  C1                      Ripple rejection
      -  C 330nF, tantalum

   o  C2-C6                   Ripple rejection, filter capacitor 
      -  C 100nF

   o  C7
      -  C 10nF

   o  CON1                    Power input [+12V GND]
      -  Phoenix Contact 

   o  CON2                    Data input [GND RXD TXD]
      -  Phoenix Contact 

   o  CON3 CON4               Character LCD
      -  Molex 2.54mm KK Header (8-way)
      -  Molex 2.54mm KK Header (8-way)

   o  D1 D2                   Reverse protection (blocking diode)
      -  1N4007

   o  D3                      Reverse flow protection (12V 5V)
      -  1N4007

   o  D4 D5                   Charge/discarge
      -  1N5158

   o  E1                      Input smoothing
      -  E 100uF /25V

   o  E2                      Output smoothing
      -  E 10uF /25V

   o  E3 E4 E5 E6             MAX232
      -  E 1uF

   o  E7                      Low-pass filter                           t = RC;  100 * (1 / Freq) ? t 
      -  E 1000uF /25V   (real value is 700uF)                          E7 = 100 * (1 / Freq) / R5        (*1000000 for uF)

   o  IC1                     Linear voltage converter
      -  L7805CV

   o  IC2                     RS-232 levels to TTL
      -  MAX232                                                           {RS 660-8613}

   o  IC3
      -  PIC16F628-04

   o  IC4
      -  LM555

   o  IC5
      -  IRF540

   o  LED1                    LED1 (power indicator)
      -  3mm red

   o  R1                      LED1
      -  1K

   o  R2                      Pull-up for RA4      
      -  10K

   o  R3
      -  10K

   o  R4 R5                   Backlight protection / low pass filter
      -  10 /3W


   o  RT1                     Contrast
      -  10K

   o  RT2                     Backlight duty cycle and frequency        Freq = 1.44 / (RT2 * C7) = 1.44 / (1000 * 0.0000001) = 14.4 kHz  
      -  1K


CASE

   o  Side element 11.25 mm
      -  PhoenixContact 2970002 (UMK-SE 11,25)                            {RS 192-2709}
      -  PhoenixContact 2970442 (UMK-SE 11,25-1)                          {RS 192-2715}

   o  Base element 45.00 mm (1x)
      -  PhoenixContact 

   o  Foot element (DIN rail)
      -  PhoenixContact 2970031 (UMK-FE)                                  {RS 192-2765}


EXPLANATIONS

o  Since backlight is PWM modulated, we need to use alternate method in
   order to determine proper potentiometer (RT2) position. Standard
   calculations call for input voltage (always 12V), backligh forward
   voltage (e.g. 4.2V) and backlight forward current (e.g. 0.480A). With
   that we can use R = (Vin - Vf) / If to calculate resistor value (in
   this example that would be 16 ohm). This board has resistance fixed
   to 10 ohms and Vin is adjusted instead. To get that value we need to
   use formula Vin = 10*If + Vf (in this example that would result in
   9V). That can be obtained by setting duty cycle to 75%.

o  This board features two display connectors. Both displays share
   constrast and backlight connections so only displays with similar
   characteristics can be used. 


LCD INTERFACE

   Elsidi uses total of 11 control lines for sending text and
   instructions to LCD these lines are:
    
      RS       Selects registers.
      R/W      Selects read or write.
      E        Starts data read/write.
      DB0-DB3  Four low order bidirectional tristate data bus pins.
      DB4-DB7  Four high order bidirectional tristate data bus pins.

   All lines except for E are multiplexed between two supported LCD
   devices. E is controled separately for primary (E1) and secondary
   LCD display (E2). Only one display can be controlled at any time.
   
   Currently all 8 data lines are used for controlling LCD.


USART INTERFACE

    Hardware interface
    
       Three wires are used - RXD, TXD and GND. All data is sent in
       ASCII at 9600 baud, 1 stop bit and no parity.

   Modes of operation

      Text mode will write each character to LCD as it comes while
      holding RS high. Instruction mode will write each character to LCD
      while holding RS low (thus directly controlling LCD instructions).
      Text mode is always used unless specified otherwise by command
      characters.

   Command characters
    
      Command characters are in ASCII range 0x08-0x0F (8-15 decimal).
      This range was selected since only CGRAM characters are here and
      they can be selected within 0x00-0x07 range. Here is meaning of
      characters:

         0x08 BS   Reserved for future use.
         0x09 HT   Next line.
         0x0A LF   Execute.
         0x0B VT   Reserved for future use.
         0x0C FF   LCD instruction mode.
         0x0D CR   Return home.
         0x0E SO   Select secondary display.
         0x0F SI   Select primary display.

         Next line (HT)

            Moves LCD cursor to next line. It is included as helper
            method for controlling display from command line. Display is
            always considered as having four lines and stops will be at
            locations: 0x00 (first line), 0x40 (second line), 0x14
            (third line) and 0x54 (fourth line). After fourth line no
            movement will be made until line is resetted (via CR
            command).

         Execute (LF)
    
            Executes saved buffer. During execution no further input is
            received. When execution is done single LF will be sent to
            USART. After execution is done, LCD will be left in text
            mode and control will be given to primary display. 

         LCD instruction mode (FF)

            Causes character that follows to be interpreted as direct
            instruction for LCD. Next character will be sent to LCD with
            RS signal kept low. E.g. <FF> 0x02 will cause LCD to execute
            Return home command. After instruction character, all
            further characters are interpreted as usual.

         Return home (CR)

            Executes Return home LCD instruction. Result will be same as
            <FF> 0x02 was executed. It is included as helper method for
            controlling display from command line. This command will
            also reset tab position back to first line.

         Select secondary display (SO)
        
            Characters after this one will cause E2 line to be driven
            and thus secondary display will receive all input. This
            command must be used for each execution since primary
            display will be used by default.

         Select primary display (SI)
        
            All further characters are executed via driving E1 line and
            thus controling primary display. 

   LCD startup sequence
    
      Startup sequence is executed each time hardware is restarted. It
      is defined within device's EEPROM in same format as one used for
      USART communication and thus it must end with LF. After all is
      done, single LF will be sent to USART. As execution is finished
      LCD control will be set to primary display and text mode will be
      selected.

   Normal behaviour
    
      All characters received are saved in buffer with optional echoing
      to computer (echoing is currently not used but it must be
      expected). Once execute command is detected (LF), all characters
      are  sent as data toward LCD until one of command characters is
      encountered. After execution is done LF is sent back to
      computer, state returns to text mode and buffer is ready to
      receive new characters. If buffer size (208 bytes) is exceeded
      all further characters except LF are ignored.
